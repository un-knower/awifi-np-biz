var _Entity_=function(state,divId){var _state=state||{style:"st1",active:"mobile",display:"mobile",tabNum:2,hasFree:true,freeButtonDsp:"点击免费上网",hasMobile:true,mobileTitle:"手机号认证",hasUserPass:true,userPassTitle:"静态用户名认证"};if(_state.hasFree&&_LOGIN_TYPE==="authed"){_state.active="free";_state.display="free"}var smsUrl="http://192.168.10.61:8084/auth/sendSmsCode.htm";var phoneAuthUrl="http://192.168.10.61:8084/auth/phoneAuth.htm";var userLoginUrl="/staticuser/phoneAuth";var AuthComponent=React.createClass({displayName:"AuthComponent",getInitialState:function(){return _state},handleTabClick:function(e){var tabObj=e.target;var childNodes=tabObj.childNodes;var tabContent=childNodes[0].innerHTML;if(tabContent==undefined){tabContent=tabObj.innerHTML}if(tabContent===_state.mobileTitle){_state.active="mobile";_state.display="mobile"}else if(tabContent===_state.userPassTitle){_state.active="userPass";_state.display="userPass"}this.setState(_state)},render:function(){return React.createElement("div",{className:"_entity_ "+this.state.style},React.createElement("div",{className:(this.state.tabNum>1?"model clearfix ":"")+(this.state.display=="free"?"hide":"")},this.state.hasMobile&&this.state.tabNum>1?React.createElement(MobileAuthTabComponent,{active:this.state.active,click:this.handleTabClick,title:this.state.mobileTitle}):"",this.state.hasUserPass&&this.state.tabNum>1?React.createElement(UserPassAuthTabComponent,{active:this.state.active,click:this.handleTabClick,title:this.state.userPassTitle}):""),React.createElement("div",{className:"forms clearfix"},this.state.hasFree?React.createElement(FreeAuthComponent,{display:this.state.display,buttonDsp:this.state.freeButtonDsp}):"",this.state.hasMobile?React.createElement(MobileAuthComponent,{display:this.state.display}):"",this.state.hasUserPass?React.createElement(UserPassAuthComponent,{display:this.state.display}):""))}});var MobileAuthTabComponent=React.createClass({displayName:"MobileAuthTabComponent",render:function(){return React.createElement("div",{className:this.props.active=="mobile"?"active":"",onClick:this.props.click},React.createElement("div",{className:"top_title"},this.props.title))}});var UserPassAuthTabComponent=React.createClass({displayName:"UserPassAuthTabComponent",render:function(){return React.createElement("div",{className:this.props.active=="userPass"?"active":"",onClick:this.props.click},React.createElement("div",{className:"top_title"},this.props.title))}});var FreeAuthComponent=React.createClass({displayName:"FreeAuthComponent",option:{loginBtnSty:"",loginDisabled:""},getInitialState:function(){return this.option},handleLogin:function(){this.setState({loginDisabled:"disabled",loginBtnSty:"disaButton"});var mobile=_USER_PHONE;phoneAuth(mobile,"","4",this)},render:function(){return React.createElement("div",{className:"form-item "+(this.props.display=="free"?"show":"hide")},React.createElement("div",{className:"input-control"},React.createElement("input",{type:"button",className:"free "+this.state.loginBtnSty,disabled:this.state.loginDisabled,onClick:this.handleLogin,value:this.props.buttonDsp})))}});var MobileAuthComponent=React.createClass({displayName:"MobileAuthComponent",second:60,option:{getAuthCodeBtnDsp:"获取验证码",getAuthCodeBtnSty:"",getAuthCodeBtnDisabled:"",loginBtnSty:"",loginDisabled:"",mobile:"",authCode:""},getInitialState:function(){return this.option},getAuthCode:function(){var _this=this;var mobile=this.state.mobile;if(mobile===""||!/^(1[3|4|5|7|8][0-9][0-9]{8})?$/.test(mobile)){alert("请输入正确的手机号码");return}var leftTime=_this.second;this.option.getAuthCodeBtnSty="disaButton";this.option.getAuthCodeBtnDisabled="disabled";this.option.getAuthCodeBtnDsp="重新获取("+leftTime+")";_this.setState(this.option);leftTime--;var timer=setInterval(function(){if(leftTime<=0){clearInterval(timer);_this.option.getAuthCodeBtnDisabled="";_this.option.getAuthCodeBtnSty="";_this.option.getAuthCodeBtnDsp="获取验证码";_this.setState(_this.option);return}_this.option.getAuthCodeBtnDsp="重新获取("+leftTime+")";_this.setState(_this.option);leftTime--},1e3);sendSmsCode(mobile)},handleMobileChange:function(e){this.option.mobile=e.target.value;this.setState(this.option)},handleAuthCodeChange:function(e){this.option.authCode=e.target.value;this.setState(this.option)},handleLogin:function(){var mobile=this.state.mobile;var authCode=this.state.authCode;if(mobile===""||!/^(1[3|4|5|7|8][0-9][0-9]{8})?$/.test(mobile)){alert("请输入正确的手机号码");return}if(authCode===""||!/^[0-9]{6}$/.test(authCode)){alert("请输入正确的验证码");return}this.setState({loginDisabled:"disabled",loginBtnSty:"disaButton"});phoneAuth(mobile,authCode,"1",this)},render:function(){return React.createElement("div",{className:"form-item "+(this.props.display=="mobile"?"show":"hide")},React.createElement("div",{className:"input-control"},React.createElement("input",{type:"text",onChange:this.handleMobileChange,value:this.state.mobile,placeholder:"请输入手机号码"}),React.createElement("input",{type:"button",disabled:this.state.getAuthCodeBtnDisabled,className:this.state.getAuthCodeBtnSty,onClick:this.getAuthCode,value:this.state.getAuthCodeBtnDsp})),React.createElement("div",{className:"input-control"},React.createElement("input",{type:"text",onChange:this.handleAuthCodeChange,value:this.state.authCode,placeholder:"请输入验证码"}),React.createElement("input",{type:"button",value:"免费登录",className:this.state.loginBtnSty,disabled:this.state.loginDisabled,onClick:this.handleLogin})))}});var UserPassAuthComponent=React.createClass({displayName:"UserPassAuthComponent",option:{getAuthCodeBtnSty:"",getAuthCodeBtnDisabled:"",loginBtnSty:"",loginDisabled:"",userName:"",password:""},getInitialState:function(){return this.option},handleUserNameChange:function(e){this.option.userName=e.target.value;this.setState(this.option)},handlePasswordChange:function(e){this.option.password=e.target.value;this.setState(this.option)},handleLoginClick:function(){var userName=this.state.userName;var password=this.state.password;if(userName===""){alert("请输入用户名");return}if(password===""){alert("请输入密码");return}this.setState({loginDisabled:"disabled",loginBtnSty:"disaButton"});userLogin(userName,password,this)},render:function(){return React.createElement("div",{className:"form-item "+(this.props.display=="userPass"?"show":"hide")},React.createElement("div",{className:"input-control"},React.createElement("input",{type:"text",value:this.state.userName,onChange:this.handleUserNameChange,placeholder:"请输入静态用户名"})),React.createElement("div",{className:"input-control"},React.createElement("input",{type:"password",value:this.state.password,onChange:this.handlePasswordChange,placeholder:"请输入密码"}),React.createElement("input",{type:"button",onClick:this.handleLoginClick,className:this.state.loginBtnSty,disabled:this.state.loginDisabled,value:"免费登录"})))}});function redirect(){var url="/site?";url+="&global_key="+_GLOBAL_KEY;url+="&global_value="+_GLOBAL_VALUE;url+="&dev_id="+_DEV_ID;url+="&dev_mac="+_DEV_MAC;url+="&ssid="+_SSID;url+="&user_ip="+_USER_IP;url+="&user_mac="+_USER_MAC;url+="&user_phone="+_USER_PHONE;url+="&url="+_URL;url+="&login_type="+_LOGIN_TYPE;url+="&gw_address="+_GW_ADDRESS;url+="&gw_port="+_GW_PORT;url+="&nas_name="+_NAS_NAME;url+="&customer_id="+_CUSTOMER_ID;url+="&site_id="+_SITE_ID;url+="&page_type="+_PAGE_TYPE;url+="&num="+_NUM;window.location.href=url}function sendSmsCode(mobile){var option={globalKey:_GLOBAL_KEY,globalValue:_GLOBAL_VALUE,version:"4",phoneNumber:mobile,userMac:_USER_MAC,devId:_DEV_ID};$.ajax({url:smsUrl,dataType:"JSONP",jsonp:"callback",header:{"cache-control":"no-cache"},data:option,success:function(data,textStatus,jqXHR){if(data.resultCode==="0"){}else{alert("Sorry,authentication failure.")}},error:function(XHR,textStatus,errorThrown){alert("Sorry,authentication failure.")},complete:function(XHR,textStatus){}})}function phoneAuth(mobile,authCode,type,_this){var option={globalKey:_GLOBAL_KEY,globalValue:_GLOBAL_VALUE,version:"4",plateformName:"ToE",type:type,phoneNumber:mobile,userMac:_USER_MAC,devId:_DEV_ID,smsCode:authCode,userIp:_USER_IP,publicUserIp:"",apMac:_DEV_MAC,ssId:_SSID,acName:_NAS_NAME};$.ajax({url:phoneAuthUrl,dataType:"JSONP",jsonp:"callback",header:{"cache-control":"no-cache"},data:option,success:function(data,textStatus,jqXHR){if(data.resultCode==="0"){redirect()}else{alert("Sorry,authentication failure.")}},error:function(XHR,textStatus,errorThrown){alert("Sorry,authentication failure.")},complete:function(XHR,textStatus){_this.setState({loginDisabled:"",loginBtnSty:""})}})}function userLogin(userName,password,_this){var option={globalKey:_GLOBAL_KEY,globalValue:_GLOBAL_VALUE,userMac:_USER_MAC,devId:_DEV_ID,userIp:_USER_IP,apMac:_DEV_MAC,ssId:_SSID,acName:_NAS_NAME,customerId:_CUSTOMER_ID,userName:userName,password:password};$.ajax({url:userLoginUrl,type:"POST",dataType:"JSON",header:{"cache-control":"no-cache"},data:option,success:function(data,textStatus,jqXHR){if(data.result==="OK"){redirect()}else{alert(data.message);_this.setState({loginDisabled:"",loginBtnSty:""})}},error:function(XHR,textStatus,errorThrown){alert("Sorry,authentication failure.");_this.setState({loginDisabled:"",loginBtnSty:""})},complete:function(XHR,textStatus){}})}function render(){return ReactDOM.render(React.createElement(AuthComponent,null),document.getElementById(divId))}return{render:render}};